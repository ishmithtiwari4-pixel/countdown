<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <title>Riya ‚Äî Character Creator</title>
  <meta name="description" content="Flip-the-cards memory game using your photos. Works offline." />
  <style>
    :root{ --bg:#0f0a12; --ink:#fff7fb; --muted:#eacfe3; --pink2:#ffb3d6; --lilac:#a78bfa; --radius:20px; --shadow:0 14px 40px rgba(0,0,0,.35); }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink);background:
      radial-gradient(1200px 800px at 10% 120%, rgba(167,139,250,.14), transparent 60%),
      radial-gradient(1200px 800px at 80% -10%, rgba(255,143,184,.18), transparent 55%),
      linear-gradient(180deg,#130c19 0%,#0f0a12 100%)}
    .wrap{width:min(1280px,95vw);margin-inline:auto}
    header.nav{position:sticky;top:0;z-index:60;backdrop-filter:blur(12px);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border-bottom:1px solid rgba(255,255,255,.12)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:14px 4px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800}
    .brand .logo{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--pink2),var(--lilac))}
    nav ul{display:flex;gap:14px;list-style:none;margin:0;padding:0}
    nav a{color:var(--muted);text-decoration:none;padding:8px 12px;border-radius:999px;border:1px solid transparent}
    nav a:hover,nav a[aria-current="page"]{color:#fff;border-color:rgba(255,255,255,.16);background:rgba(255,255,255,.06)}
    main{padding:18px}
    .panel{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.12);border-radius:20px;padding:14px;box-shadow:var(--shadow)}
    .top{display:grid;grid-template-columns:320px 1fr;gap:16px}
    @media (max-width:980px){.top{grid-template-columns:1fr}}
    .row{display:flex;align-items:center;gap:8px;margin:8px 0}
    .btn{appearance:none;border:0;border-radius:10px;padding:8px 12px;cursor:pointer;background:linear-gradient(135deg,var(--pink2),var(--lilac));color:#160c23;font-weight:800}
    .btn.ghost{background:rgba(255,255,255,.06);color:var(--ink);border:1px solid rgba(255,255,255,.12)}
    select{height:32px;border:1px solid rgba(255,255,255,.2);border-radius:8px;background:rgba(0,0,0,.1);color:#fff;padding:0 8px}
    .board.panel{display:grid;grid-template-columns:repeat(var(--cols,4),1fr);gap:12px;align-content:start;min-height:520px}
    .card{position:relative;aspect-ratio:3/4;border-radius:16px;perspective:1000px}
    .card button{all:unset;position:absolute;inset:0;cursor:pointer;border-radius:16px;box-shadow:var(--shadow)}
    .flip{position:absolute;inset:0;transform-style:preserve-3d;transition:transform .35s ease}
    .flipped .flip{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;display:grid;place-items:center;border-radius:16px;backface-visibility:hidden;overflow:hidden}
    .front{background:linear-gradient(135deg,rgba(255,255,255,.12),rgba(255,255,255,.04));border:1px solid rgba(255,255,255,.16)}
    .back{transform:rotateY(180deg)}
    .back img{width:100%;height:100%;object-fit:cover;display:block}
    .stats{display:flex;gap:16px;flex-wrap:wrap;color:#cfd6ff}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:80}
    .overlay.show{display:flex}
    .modal{background:#1a1420;border:1px solid rgba(255,255,255,.16);border-radius:18px;padding:20px;box-shadow:var(--shadow);text-align:center;width:min(520px,92vw)}
  </style>
</head>
<body>
  <header class="nav">
    <div class="wrap nav-inner">
      <div class="brand"><div class="logo"></div><span>For Riya</span></div>
      <nav>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../gallery.html">Riya Gallery</a></li>
          <li><a href="decorator.html">Room Decorator</a></li>
          <li><a href="bouquet.html">Build-a-Bouquet</a></li>
          <li><a href="organize.html">Organization Puzzle</a></li>
          <li><a href="avatar.html" aria-current="page">Character Creator</a></li>
          <li><a href="../day.html">Image & Message</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="top">
      <aside class="panel">
        <h2>Character Creator</h2>
        <div class="row">
          <label>Difficulty</label>
          <select id="difficulty">
            <option value="4x4">Easy ‚Äî 4√ó4 (8 pairs)</option>
            <option value="5x4">Medium ‚Äî 5√ó4 (10 pairs)</option>
            <option value="6x4">Hard ‚Äî 6√ó4 (12 pairs)</option>
          </select>
        </div>
        <div class="row">
          <button class="btn" id="newGame">New Game</button>
          <button class="btn ghost" id="peek">Peek 3s</button>
        </div>
        <div class="stats row">‚è±Ô∏è <span id="time">00:00</span> ‚Ä¢ üéØ Moves: <span id="moves">0</span> ‚Ä¢ ‚úÖ Matches: <span id="matches">0</span></div>
        <p class="small">Looks for photos in the <code>same folder</code> as this page (i.e., <code>/games/1‚Ä¶63</code>). Fallbacks try many extensions.</p>
      </aside>

      <section id="board" class="board panel" style="--cols:4"></section>
    </div>
  </main>

  <div class="overlay" id="win">
    <div class="modal">
      <h2>All matched! ü•≥</h2>
      <p><strong>Time:</strong> <span id="winTime"></span> ‚Ä¢ <strong>Moves:</strong> <span id="winMoves"></span></p>
      <button class="btn" id="playAgain">Play again</button>
    </div>
  </div>

  <script>
    const board = document.getElementById('board');
    const timeEl = document.getElementById('time');
    const movesEl = document.getElementById('moves');
    const matchesEl = document.getElementById('matches');
    const diffSel = document.getElementById('difficulty');
    const newBtn = document.getElementById('newGame');
    const peekBtn = document.getElementById('peek');
    const overlay = document.getElementById('win');
    const winTime = document.getElementById('winTime');
    const winMoves = document.getElementById('winMoves');
    const playAgain = document.getElementById('playAgain');

    // ‚úÖ your images are in the SAME FOLDER as this page:
    const IMG_PATH = './';
    const EXTS = ['jpg','jpeg','png','JPG','JPEG','PNG','webp','jfif']; // robust fallbacks
    const MAX = 63;

    let timer=null, secs=0, started=false, lock=false;
    let first=null, second=null, moves=0, matches=0, totalPairs=8;

    function formatTime(s){const m=String(Math.floor(s/60)).padStart(2,'0'); const r=String(s%60).padStart(2,'0'); return m+':'+r;}
    function pickUnique(n,max){ const set=new Set(); while(set.size<n){ set.add(1+Math.floor(Math.random()*max)); } return [...set]; }
    function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [a[i],a[j]]=[a[j],a[i]]; } return a; }

    function buildDeck(cols,rows){
      totalPairs = (cols*rows)/2; matches=0; moves=0; updateStats();
      const base = pickUnique(totalPairs, MAX);
      const deck = shuffle([...base, ...base]);
      board.style.setProperty('--cols', cols);
      board.innerHTML='';
      deck.forEach((num)=> board.appendChild(card(num)) );
      started=false; secs=0; timeEl.textContent='00:00'; if(timer){clearInterval(timer);} timer=null;
    }

    function card(num){
      const wrap = document.createElement('div'); wrap.className='card';
      const btn = document.createElement('button');
      const flip = document.createElement('div'); flip.className='flip';

      const front = document.createElement('div'); front.className='face front'; front.innerHTML='<span>üíó</span>';
      const back = document.createElement('div'); back.className='face back';

      const img = document.createElement('img');
      img.className='photo'; img.alt='photo'; img.loading='lazy';
      img.dataset.idx = 0;
      img.src = IMG_PATH + num + '.' + EXTS[0];

      img.onerror = () => {
        let i = parseInt(img.dataset.idx, 10) + 1;
        if (i >= EXTS.length) return;         // give up after all attempts
        img.dataset.idx = i;
        img.src = IMG_PATH + num + '.' + EXTS[i] + '?v=' + Date.now(); // cache-bust
      };

      back.appendChild(img);
      flip.appendChild(front); flip.appendChild(back);
      btn.appendChild(flip); wrap.appendChild(btn);

      btn.addEventListener('click', ()=> onFlip(wrap, num));
      return wrap;
    }

    function startTimer(){ if(started) return; started=true; timer=setInterval(()=>{ secs++; timeEl.textContent = formatTime(secs); }, 1000); }

    function onFlip(el, id){
      if(lock || el.classList.contains('flipped')) return;
      startTimer(); el.classList.add('flipped');
      if(!first){ first = {el, id}; return; }
      second = {el, id}; lock=true; moves++; updateStats();
      if(first.id === second.id){
        setTimeout(()=>{ first.el.classList.add('done'); second.el.classList.add('done'); resetPick(); matches++; updateStats(); if(matches===totalPairs) win(); }, 350);
      } else {
        setTimeout(()=>{ first.el.classList.remove('flipped'); second.el.classList.remove('flipped'); resetPick(); }, 800);
      }
    }

    function resetPick(){ first=null; second=null; lock=false; }
    function updateStats(){ movesEl.textContent=moves; matchesEl.textContent=matches+'/'+totalPairs; }
    function win(){ clearInterval(timer); timer=null; winTime.textContent=formatTime(secs); winMoves.textContent=moves; overlay.classList.add('show'); }
    playAgain.onclick=()=>{ overlay.classList.remove('show'); newGame(); };

    newBtn.onclick = newGame;
    peekBtn.onclick = ()=>{
      const all=[...board.querySelectorAll('.card')]; all.forEach(c=>c.classList.add('flipped'));
      setTimeout(()=>{ all.forEach(c=>{ if(!c.classList.contains('done')) c.classList.remove('flipped'); }); }, 3000);
    };

    function newGame(){
      const v = diffSel.value; let cols=4, rows=4;
      if(v==='5x4'){ cols=5; rows=4; }
      if(v==='6x4'){ cols=6; rows=4; }
      buildDeck(cols,rows);
    }

    // init
    newGame();
  </script>
</body>
</html>
